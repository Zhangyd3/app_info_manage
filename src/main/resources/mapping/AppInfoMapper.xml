<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zyd.appinfo.mapper.AppInfoMapper">
  <cache></cache>
  <select id="findAppByAppInfo" resultType="com.zyd.appinfo.pojo.AppInfo">
    select APKName,softwareName,softwareSize,flatformId,dd2.valueName flatformName,status,dd.valueName statusName,downloads,versionId,av.versionNo versionNo,categoryLevel1,categoryLevel2,categoryLevel3,ac1.categoryName categoryLevel1Name,ac2.categoryName categoryLevel2Name,ac3.categoryName categoryLevel3Name  from app_info i left join data_dictionary dd on i.status = dd.valueId and dd.typeCode='APP_STATUS'
    left join app_category ac1 on i.categoryLevel1 = ac1.id
    left join data_dictionary dd2 on i.flatformId = dd2.valueId and dd2.typeCode='APP_FLATFORM'
    left join app_category ac2 on i.categoryLevel2 = ac2.id
    left join app_category ac3 on i.categoryLevel3 = ac3.id
    left join app_version av on i.versionId = av.id
    <where>
        <if test="appInfo.categoryLevel1 !=null and appInfo.categoryLevel1 != 0 ">
          categoryLevel1=#{appInfo.categoryLevel1}
        </if>
      <if test="appInfo.categoryLevel2 !=null and appInfo.categoryLevel2 != 0 ">
            and categoryLevel2=#{appInfo.categoryLevel2}
      </if>
      <if test="appInfo.categoryLevel3 !=null and appInfo.categoryLevel3 != 0 ">
        and categoryLevel3=#{appInfo.categoryLevel3}
      </if>
      <if test="appInfo.flatformId !=null and appInfo.flatformId != 0 ">
        and flatformId=#{appInfo.flatformId}
      </if>
      <if test="appInfo.status !=null and appInfo.status != 0 ">
        and status=#{appInfo.status}
      </if>
      <if test="appInfo.softwareName !=null ">
        and softwareName like concat('%',#{appInfo.softwareName},'%')
      </if>
    </where>
     limit #{start},5
  </select>
</mapper>